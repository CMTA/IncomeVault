<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 5.0.0 (20220707.1540)
 -->
<!-- Title: UmlClassDiagram Pages: 1 -->
<svg width="1430pt" height="1073pt"
 viewBox="0.00 0.00 1430.47 1072.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1068.8)">
<title>UmlClassDiagram</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1068.8 1426.47,-1068.8 1426.47,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<polygon fill="#f2f2f2" stroke="black" points="0,-0.5 0,-226.1 1398.68,-226.1 1398.68,-0.5 0,-0.5"/>
<text text-anchor="middle" x="699.34" y="-209.5" font-family="Times,serif" font-size="14.00">IncomeVault</text>
<text text-anchor="middle" x="699.34" y="-192.7" font-family="Times,serif" font-size="14.00">src/IncomeVault.sol</text>
<polyline fill="none" stroke="black" points="0,-184.5 1398.68,-184.5 "/>
<text text-anchor="start" x="8" y="-167.9" font-family="Times,serif" font-size="14.00">Private:</text>
<text text-anchor="start" x="8" y="-151.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;__gap: uint256[50]</text>
<polyline fill="none" stroke="black" points="0,-142.9 1398.68,-142.9 "/>
<text text-anchor="start" x="8" y="-126.3" font-family="Times,serif" font-size="14.00">Internal:</text>
<text text-anchor="start" x="8" y="-109.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;__IncomeVault_init(admin: address, ERC20TokenPayment_: IERC20, cmtat_token: ICMTATSnapshot, ruleEngine_: IRuleEngine, authorizationEngineIrrevocable: IAuthorizationEngine, timeLimitToWithdraw_: uint256) &lt;&lt;onlyInitializing&gt;&gt;</text>
<text text-anchor="start" x="8" y="-92.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;_msgSender(): (sender: address)</text>
<text text-anchor="start" x="8" y="-75.9" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;_msgData(): bytes</text>
<text text-anchor="start" x="8" y="-59.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;_contextSuffixLength(): uint256</text>
<text text-anchor="start" x="8" y="-42.3" font-family="Times,serif" font-size="14.00">Public:</text>
<text text-anchor="start" x="8" y="-25.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;constructor(forwarderIrrevocable: address)</text>
<text text-anchor="start" x="8" y="-8.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;initialize(admin: address, ERC20TokenPayment_: IERC20, cmtat_token: ICMTATSnapshot, ruleEngine_: IRuleEngine, authorizationEngineIrrevocable: IAuthorizationEngine, timeLimitToWithdraw_: uint256) &lt;&lt;initializer&gt;&gt;</text>
</g>
<!-- 3 -->
<g id="node5" class="node">
<title>3</title>
<polygon fill="#f2f2f2" stroke="black" points="244.68,-288.3 244.68,-497.1 646,-497.1 646,-288.3 244.68,-288.3"/>
<text text-anchor="middle" x="445.34" y="-480.5" font-family="Times,serif" font-size="14.00">&lt;&lt;Abstract&gt;&gt;</text>
<text text-anchor="middle" x="445.34" y="-463.7" font-family="Times,serif" font-size="14.00">IncomeVaultOpen</text>
<text text-anchor="middle" x="445.34" y="-446.9" font-family="Times,serif" font-size="14.00">src/public/IncomeVaultOpen.sol</text>
<polyline fill="none" stroke="black" points="244.68,-438.7 646,-438.7 "/>
<text text-anchor="start" x="252.68" y="-422.1" font-family="Times,serif" font-size="14.00">Private:</text>
<text text-anchor="start" x="252.68" y="-405.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;__gap: uint256[50]</text>
<polyline fill="none" stroke="black" points="244.68,-397.1 646,-397.1 "/>
<text text-anchor="start" x="252.68" y="-380.5" font-family="Times,serif" font-size="14.00">Public:</text>
<text text-anchor="start" x="252.68" y="-363.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;validateTimeCode(time: uint256): (code: TIME_ERROR_CODE)</text>
<text text-anchor="start" x="252.68" y="-346.9" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;validateTime(time: uint256)</text>
<text text-anchor="start" x="252.68" y="-330.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;validateTimeBatch(times: uint256[])</text>
<text text-anchor="start" x="252.68" y="-313.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;claimDividend(time: uint256) &lt;&lt;nonReentrant&gt;&gt;</text>
<text text-anchor="start" x="252.68" y="-296.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;claimDividendBatch(times: uint256[]) &lt;&lt;nonReentrant&gt;&gt;</text>
</g>
<!-- 0&#45;&gt;3 -->
<g id="edge2" class="edge">
<title>0&#45;&gt;3</title>
<path fill="none" stroke="black" d="M596.76,-226.33C584.91,-239.27 572.77,-252.53 560.76,-265.64"/>
<polygon fill="none" stroke="black" points="552.6,-259 540.09,-288.22 568.09,-273.19 552.6,-259"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<polygon fill="#f2f2f2" stroke="black" points="663.61,-263.1 663.61,-522.3 1243.07,-522.3 1243.07,-263.1 663.61,-263.1"/>
<text text-anchor="middle" x="953.34" y="-505.7" font-family="Times,serif" font-size="14.00">&lt;&lt;Abstract&gt;&gt;</text>
<text text-anchor="middle" x="953.34" y="-488.9" font-family="Times,serif" font-size="14.00">IncomeVaultRestricted</text>
<text text-anchor="middle" x="953.34" y="-472.1" font-family="Times,serif" font-size="14.00">src/public/IncomeVaultRestricted.sol</text>
<polyline fill="none" stroke="black" points="663.61,-463.9 1243.07,-463.9 "/>
<text text-anchor="start" x="671.61" y="-447.3" font-family="Times,serif" font-size="14.00">Private:</text>
<text text-anchor="start" x="671.61" y="-430.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;__gap: uint256[50]</text>
<polyline fill="none" stroke="black" points="663.61,-422.3 1243.07,-422.3 "/>
<text text-anchor="start" x="671.61" y="-405.7" font-family="Times,serif" font-size="14.00">Internal:</text>
<text text-anchor="start" x="671.61" y="-388.9" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;__IncomeVaultRestricted_init_unchained(timeLimitToWithdraw_: uint256) &lt;&lt;onlyInitializing&gt;&gt;</text>
<text text-anchor="start" x="671.61" y="-372.1" font-family="Times,serif" font-size="14.00">Public:</text>
<text text-anchor="start" x="671.61" y="-355.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;deposit(time: uint256, amount: uint256) &lt;&lt;onlyRole&gt;&gt;</text>
<text text-anchor="start" x="671.61" y="-338.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;withdraw(time: uint256, amount: uint256, withdrawAddress: address) &lt;&lt;onlyRole&gt;&gt;</text>
<text text-anchor="start" x="671.61" y="-321.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;withdrawAll(amount: uint256, withdrawAddress: address) &lt;&lt;onlyRole&gt;&gt;</text>
<text text-anchor="start" x="671.61" y="-304.9" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;distributeDividend(addresses: address[], time: uint256) &lt;&lt;onlyRole&gt;&gt;</text>
<text text-anchor="start" x="671.61" y="-288.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;setStatusClaim(time: uint256, status: bool) &lt;&lt;onlyRole&gt;&gt;</text>
<text text-anchor="start" x="671.61" y="-271.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;setTimeLimitToWithdraw(timeLimitToWithdraw_: uint256) &lt;&lt;onlyRole&gt;&gt;</text>
</g>
<!-- 0&#45;&gt;5 -->
<g id="edge1" class="edge">
<title>0&#45;&gt;5</title>
<path fill="none" stroke="black" d="M801.92,-226.33C806.22,-231.03 810.56,-235.77 814.92,-240.53"/>
<polygon fill="none" stroke="black" points="807.37,-247.84 835.38,-262.87 822.86,-233.66 807.37,-247.84"/>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<polygon fill="#f2f2f2" stroke="black" points="484.21,-559.3 484.21,-818.5 1422.47,-818.5 1422.47,-559.3 484.21,-559.3"/>
<text text-anchor="middle" x="953.34" y="-801.9" font-family="Times,serif" font-size="14.00">&lt;&lt;Abstract&gt;&gt;</text>
<text text-anchor="middle" x="953.34" y="-785.1" font-family="Times,serif" font-size="14.00">IncomeVaultInternal</text>
<text text-anchor="middle" x="953.34" y="-768.3" font-family="Times,serif" font-size="14.00">src/libraries/IncomeVaultInternal.sol</text>
<polyline fill="none" stroke="black" points="484.21,-760.1 1422.47,-760.1 "/>
<text text-anchor="start" x="492.21" y="-743.5" font-family="Times,serif" font-size="14.00">Public:</text>
<text text-anchor="start" x="492.21" y="-726.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;CMTAT_TOKEN: ICMTATSnapshot</text>
<text text-anchor="start" x="492.21" y="-709.9" font-family="Times,serif" font-size="14.00"> &#160;&#160;ERC20TokenPayment: IERC20</text>
<text text-anchor="start" x="492.21" y="-693.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;claimedDividend: mapping(address=&gt;mapping(uint256=&gt;bool))</text>
<text text-anchor="start" x="492.21" y="-676.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;segregatedDividend: mapping(uint256=&gt;uint256)</text>
<text text-anchor="start" x="492.21" y="-659.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;segregatedClaim: mapping(uint256=&gt;bool)</text>
<text text-anchor="start" x="492.21" y="-642.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;timeLimitToWithdraw: uint256</text>
<polyline fill="none" stroke="black" points="484.21,-634.5 1422.47,-634.5 "/>
<text text-anchor="start" x="492.21" y="-617.9" font-family="Times,serif" font-size="14.00">Internal:</text>
<text text-anchor="start" x="492.21" y="-601.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;_computeDividendBatch(time: uint256, tokenHolders: address[], tokenHoldersBalance: uint256[], tokenTotalSupply: uint256): (tokenHolderDividend: uint256[])</text>
<text text-anchor="start" x="492.21" y="-584.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;_computeDividend(time: uint256, senderBalance: uint256, tokenTotalSupply: uint256): (tokenHolderDividend: uint256)</text>
<text text-anchor="start" x="492.21" y="-567.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;_transferDividend(time: uint256, tokenHolder: address, tokenHolderDividend: uint256)</text>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<polygon fill="#f2f2f2" stroke="black" points="714.14,-855.5 714.14,-1064.3 1192.53,-1064.3 1192.53,-855.5 714.14,-855.5"/>
<text text-anchor="middle" x="953.34" y="-1047.7" font-family="Times,serif" font-size="14.00">&lt;&lt;Abstract&gt;&gt;</text>
<text text-anchor="middle" x="953.34" y="-1030.9" font-family="Times,serif" font-size="14.00">IncomeVaultInvariantStorage</text>
<text text-anchor="middle" x="953.34" y="-1014.1" font-family="Times,serif" font-size="14.00">src/libraries/IncomeVaultInvariantStorage.sol</text>
<polyline fill="none" stroke="black" points="714.14,-1005.9 1192.53,-1005.9 "/>
<text text-anchor="start" x="722.14" y="-989.3" font-family="Times,serif" font-size="14.00">Public:</text>
<text text-anchor="start" x="722.14" y="-972.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;INCOME_VAULT_OPERATOR_ROLE: bytes32</text>
<text text-anchor="start" x="722.14" y="-955.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;INCOME_VAULT_DEPOSIT_ROLE: bytes32</text>
<text text-anchor="start" x="722.14" y="-938.9" font-family="Times,serif" font-size="14.00"> &#160;&#160;INCOME_VAULT_DISTRIBUTE_ROLE: bytes32</text>
<text text-anchor="start" x="722.14" y="-922.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;INCOME_VAULT_WITHDRAW_ROLE: bytes32</text>
<polyline fill="none" stroke="black" points="714.14,-913.9 1192.53,-913.9 "/>
<text text-anchor="start" x="722.14" y="-897.3" font-family="Times,serif" font-size="14.00">Public:</text>
<text text-anchor="start" x="722.14" y="-880.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; newDeposit(time: uint256, sender: address, dividend: uint256)</text>
<text text-anchor="start" x="722.14" y="-863.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; DividendClaimed(time: uint256, sender: address, dividend: uint256)</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge3" class="edge">
<title>1&#45;&gt;2</title>
<path fill="none" stroke="black" d="M953.34,-818.88C953.34,-820.99 953.34,-823.1 953.34,-825.21"/>
<polygon fill="none" stroke="black" points="942.84,-825.47 953.34,-855.47 963.84,-825.47 942.84,-825.47"/>
</g>
<!-- 4 -->
<g id="node4" class="node">
<title>4</title>
<polygon fill="#f2f2f2" stroke="black" points="240.94,-622.1 240.94,-755.7 465.74,-755.7 465.74,-622.1 240.94,-622.1"/>
<text text-anchor="middle" x="353.34" y="-739.1" font-family="Times,serif" font-size="14.00">&lt;&lt;Enum&gt;&gt;</text>
<text text-anchor="middle" x="353.34" y="-722.3" font-family="Times,serif" font-size="14.00">TIME_ERROR_CODE</text>
<text text-anchor="middle" x="353.34" y="-705.5" font-family="Times,serif" font-size="14.00">src/public/IncomeVaultOpen.sol</text>
<polyline fill="none" stroke="black" points="240.94,-697.3 465.74,-697.3 "/>
<text text-anchor="start" x="248.94" y="-680.7" font-family="Times,serif" font-size="14.00">OK: 0</text>
<text text-anchor="start" x="248.94" y="-663.9" font-family="Times,serif" font-size="14.00">CLAIM_NOT_ACTIVATED: 1</text>
<text text-anchor="start" x="248.94" y="-647.1" font-family="Times,serif" font-size="14.00">TOO_LATE_TO_WITHDRAW: 2</text>
<text text-anchor="start" x="248.94" y="-630.3" font-family="Times,serif" font-size="14.00">TOO_EARLY_TO_WITHDRAW: 3</text>
</g>
<!-- 4&#45;&gt;3 -->
<g id="edge4" class="edge">
<title>4&#45;&gt;3</title>
<path fill="none" stroke="black" d="M379.75,-621.8C391.06,-588.6 404.23,-547.39 415.84,-509.18"/>
<polygon fill="black" stroke="black" points="415.92,-508.91 413.82,-502.01 419.39,-497.42 421.48,-504.32 415.92,-508.91"/>
</g>
<!-- 3&#45;&gt;1 -->
<g id="edge5" class="edge">
<title>3&#45;&gt;1</title>
<path fill="none" stroke="black" d="M611.17,-497.15C625.71,-505.91 640.25,-514.57 654.34,-522.8 666.5,-529.91 678.97,-537.12 691.6,-544.35"/>
<polygon fill="none" stroke="black" points="686.43,-553.48 717.69,-559.19 696.81,-535.23 686.43,-553.48"/>
</g>
<!-- 3&#45;&gt;4 -->
<g id="edge6" class="edge">
<title>3&#45;&gt;4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M406.42,-497.42C394.12,-535.23 381.15,-577.23 371.04,-612.15"/>
<polygon fill="black" stroke="black" points="367.66,-611.23 368.27,-621.8 374.39,-613.16 367.66,-611.23"/>
</g>
<!-- 5&#45;&gt;1 -->
<g id="edge7" class="edge">
<title>5&#45;&gt;1</title>
<path fill="none" stroke="black" d="M953.34,-522.31C953.34,-524.51 953.34,-526.71 953.34,-528.91"/>
<polygon fill="none" stroke="black" points="942.84,-529.13 953.34,-559.13 963.84,-529.13 942.84,-529.13"/>
</g>
</g>
</svg>
